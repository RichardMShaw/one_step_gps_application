(function(){"use strict";var e={6076:function(e,t,i){var s=i(144),n=function(){var e=this,t=e._self._c;return t("v-app",[t("v-app-bar",{staticClass:"app-bar",attrs:{app:""}},[t("div",{staticClass:"d-flex align-center"},[t("v-img",{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:i(7504),transition:"scale-transition",width:"60"}})],1),t("v-spacer")],1),t("v-main",[t("router-view")],1)],1)},r=[],o={name:"App",data:()=>({})},a=o,d=i(1001),c=i(3453),l=i.n(c),v=i(998),u=i(6843),h=i(5495),p=i(3059),g=i(3687),m=(0,d.Z)(a,n,r,!1,null,"7524f421",null),f=m.exports;l()(m,{VApp:v.Z,VAppBar:u.Z,VImg:h.Z,VMain:p.Z,VSpacer:g.Z});var _=i(8345),S=function(){var e=this,t=e._self._c;return t("device-page")},y=[],D=function(){var e=this,t=e._self._c;return t("v-container",{staticClass:"home-containter"},[t("v-row",{staticClass:"no-margin"},[t("v-navigation-drawer",{attrs:{dark:"","mini-variant":"","mini-variant-width":"56",permanent:""}},[t("v-list",{attrs:{dense:"",nav:""}},[t("v-list-item",[t("v-list-item-action",[t("v-icon",{on:{click:function(t){t.stopPropagation(),e.device=!e.device}}},[e._v("mdi-compass")])],1)],1)],1)],1),e.device?t("device-table"):e._e(),e.showMap?t("device-map",{staticClass:"map",attrs:{devices:e.shownDevices}}):e._e(),e.layoutModel?t("layout-model",{attrs:{"z-index":0}}):e._e(),e.deviceIconModel.show?t("device-icon-model",{attrs:{"z-index":0}}):e._e()],1)],1)},k=[],b=function(){var e=this,t=e._self._c;return t("v-data-table",{staticClass:"elevation-1 table-settings",attrs:{headers:e.headers,items:e.devices,expanded:e.expanded,"item-class":e.getRowBackground,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"item-key":"device_id","hide-default-footer":""},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"click:row":e.expand},scopedSlots:e._u([{key:"top",fn:function(){return[t("div",{staticStyle:{display:"flex"}},[t("v-tabs",{attrs:{"background-color":e.tabColor,"center-active":"",dark:"","show-arrows":""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("v-tabs-slider",{attrs:{color:"yellow"}}),e._l(e.tabs,(function(i,s){return t("v-tab",{key:s,on:{click:function(t){return e.filterDevices(i)}}},[e._v(" "+e._s(`${i} (${e.deviceStatusCount[i]})`)+" ")])})),t("v-spacer"),t("v-btn",{attrs:{height:"100%",dark:""},on:{click:function(t){return e.$store.dispatch("showLayoutModel")}}},[e._v(" Layout "),t("v-icon",{attrs:{right:"",dark:""}},[e._v(" mdi-cog ")])],1)],2)],1)]},proxy:!0},{key:"header.show",fn:function(){return[t("v-icon",{on:{click:e.setAllHiddenDevices}},[e._v(e._s(e.eyeIcon))])]},proxy:!0},{key:"item.show",fn:function({item:i}){return[t("td",{staticClass:"show-icon-td"},[t("v-simple-checkbox",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}],attrs:{value:!e.hiddenSettings[i.device_id],color:"blue"},on:{click:function(t){return e.changeHiddenDevice(i)}}})],1)]}},{key:"item.icon",fn:function({item:i}){return[t("v-avatar",{attrs:{tile:""},on:{click:function(t){return t.stopPropagation(),e.changeIcon(i)}}},[t("img",{attrs:{src:`${e.getIcon(i)}`}})])]}},{key:"item.odometer_mi",fn:function({item:t}){return[e._v(" "+e._s(t.odometer_mi_display)+" ")]}},{key:"item.odometer_km",fn:function({item:t}){return[e._v(" "+e._s(t.odometer_km_display)+" ")]}},{key:"item.speed_mph",fn:function({item:t}){return[e._v(" "+e._s(e.getInt(t.speed_mph))+" ")]}},{key:"item.speed_kph",fn:function({item:t}){return[e._v(" "+e._s(e.getInt(t.speed_kph))+" ")]}},{key:"item.drive_status",fn:function({item:t}){return[e._v(" "+e._s(t.drive_status_display)+" ")]}},{key:"item.drive_status_duration",fn:function({item:t}){return[e._v(" "+e._s(t.drive_status_duration_display)+" ")]}},{key:"item.active_state",fn:function({item:i}){return[t("v-icon",{attrs:{color:e.getActiveStateColor(i.active_state)}},[e._v(" "+e._s(e.getActiveStateIcon(i.active_state))+" ")])]}},{key:"item.rssi",fn:function({item:i}){return[t("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:n}){return[t("v-icon",e._g(e._b({attrs:{color:e.getSignalColor(i.online)}},"v-icon",n,!1),s),[e._v(" "+e._s(e.getSignalIcon(i))+" ")])]}}],null,!0)},[t("span",[e._v(e._s(e.getSignalInfo(i)))])])]}},{key:"expanded-item",fn:function({item:i}){return[t("td",{staticStyle:{padding:"0"},attrs:{colspan:e.headers.length}},[t("device-table-expanded-item",{attrs:{item:i}})],1)]}}])})},w=[],I=i(9669),H=i.n(I),x=i(629),C=i(4576);const M=e=>{if(e<1)return"0 s";let t=e,i=Math.floor(t/86400);t%=86400;let s=Math.floor(t/3600);t%=3600;let n=Math.floor(t/60);t%=60;let r=t,o=r?`${r} s`:"",a=n?`${n} m`:"",d=s?`${s} h`:"",c=i?`${i} d`:"",l=`${c} ${d} ${a} ${o}`;return l.trim()},$=(e,t)=>{let i={km:0,mi:0};return"km"==e?(i.km=t,i.mi=t/1.609344):"m"==e?(i.km=t/1e3,i.mi=i.km/1.609344):(i.mi=t,i.km=1.609344*t),i},T=(e,t)=>{let i={kph:0,mph:0};return"km/h"==e?(i.kph=t,i.mph=t/1.609344):(i.mph=t,i.kph=1.609344*t),i},A=e=>new Date(e).toLocaleDateString("en-us",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});class L{constructor(e){this.device_id=e.device_id,this.show=!0,this.display_name=e.display_name,this.active_state=e.active_state,this.model=e.model,this.online=e.online;let t=e.latest_accurate_device_point;if(t){this.lat=t.lat,this.lng=t.lng;let e=Math.floor(1e6*this.lat)/1e6,i=Math.floor(1e6*this.lng)/1e6;this.position=`${e}°,${i}°`,this.angle=t.angle,this.dt_server=t.dt_server,this.dt_server_display=A(t.dt_server),this.dt_tracker=t.dt_tracker,this.dt_tracker_display=A(t.dt_tracker);let s=t.device_point_detail;if(s){let e=T(s.speed.unit,s.speed.value);this.speed_mph=Math.floor(e.mph),this.speed_kph=Math.floor(e.kph),this.heading=s.heading,this.rssi=s.rssi,this.external_volt=s.external_volt,this.battery=`${s.external_volt} Volts`}let n=t.params;n&&(this.gpslev=n.gpslev);let r=t.device_state;if(r){if(this.online){let e=r.drive_status.toUpperCase();e="OFF"==e?"STOPPED":e,this.drive_status=e,this.drive_status_display=e;let t=r.drive_status_duration.value;this.drive_status_duration=t,this.drive_status_duration_display=M(t)}else{this.drive_status="NOSIGNAL",this.drive_status_display="NO SIGNAL";let e=new Date,i=new Date(t.dt_server),s=Math.floor((e.getTime()-i.getTime())/1e3);this.drive_status_duration=s,this.drive_status_duration_display=M(s)}this.drive_status_and_duration=`${this.drive_status_display} ${this.drive_status_duration_display}`;let e=r.odometer;if(Object.keys(e).length){let e=$(r.odometer.unit,r.odometer.value);this.odometer_mi=Math.floor(e.mi),this.odometer_km=Math.floor(e.km)}this.odometer_mi_display=void 0!==this.odometer_mi?this.odometer_mi:"UNKNOWN",this.odometer_km_display=void 0!==this.odometer_km?this.odometer_km:"UNKNOWN"}}}}var Z=L;const F={getDevices:()=>H().get("/api/device")};var O=F;const P={text:"Show",align:"center",value:"show",sortable:!1,hideInExpand:!0},V={text:"Icon",align:"center",value:"icon",sortable:!1,hideInExpand:!0},N={text:"Name",align:"left",value:"display_name"},B={text:"Drive Status",align:"center",value:"drive_status"},E={text:"Status Duration",align:"left",value:"drive_status_duration"},G={text:"Position",align:"left",value:"position"},j={text:"Model",align:"left",value:"model"},W={text:"Odometer (mi)",align:"right",value:"odometer_mi_display"},z={text:"Odometer (km)",align:"right",value:"odometer_km_display"},R={text:"MPH",align:"right",value:"speed_mph"},U={text:"KPH",align:"right",value:"speed_kph"},K={text:"Battery",algin:"left",value:"battery"},q={text:"GPS Sat",align:"right",value:"gpslev"},J={text:"Time (server)",align:"center",value:"dt_server_display"},Y={text:"Time (position)",align:"center",value:"dt_tracker_display"},Q={text:"Signal",align:"center",value:"rssi"},X={text:"Active",align:"center",value:"active_state"},ee=[P,V,N,B,E,G,j,W,z,R,U,K,q,J,Y,Q,X],te=[...ee].sort(((e,t)=>e.text.toLowerCase()<t.text.toLowerCase()?-1:e.text.toLowerCase()>t.text.toLowerCase()?1:0)),ie=[...te].filter((e=>!e.hideInExpand)),se={show:!0,icon:!0,display_name:!0,model:!0,odometer_mi_display:!0,speed_mph:!0,drive_status:!0,drive_status_duration:!0,rssi:!0,active_state:!0},{getDevices:ne}=O;s.ZP.use(x.ZP);var re=new x.ZP.Store({state:{mapTypeId:"terrain",getDevicesTimeout:null,layoutModel:!1,deviceIcons:{},deviceIconModel:{device:null,show:!1},devices:[],deviceHeaderSettings:null,deviceSortSettings:null,deviceHiddenSettings:null,deviceFilterSettings:null,markerCluster:null,focusDevice:null},getters:{focusDevice(e){return e.focusDevice},markerCluster(e){return e.markerCluster},deviceIcons(e){return e.deviceIcons},mapTypeId(e){return e.mapTypeId},deviceSortSettings(e){return e.deviceSortSettings},deviceHiddenSettings(e){return e.deviceHiddenSettings},devices(e){return e.devices},deviceStatusFilter(e){return e.deviceFilterSettings},devicesFilterByStatus(e){let t=e.deviceFilterSettings;return t&&"ALL"!=t?e.devices.filter((e=>e.drive_status==t)):e.devices},devicesFilterByStatusAndHidden(e,t){let i=t.devicesFilterByStatus,s=t.deviceHiddenSettings;return s?i.filter((e=>!s[e.device_id])):i},layoutModel(e){return e.layoutModel},deviceHeaderSettings(e){return e.deviceHeaderSettings},deviceHeadersFiltered(e){return e.deviceHeaderSettings?ee.filter((t=>e.deviceHeaderSettings[t.value])):ee.filter((e=>se[e.value]))},deviceIconModel(e){return e.deviceIconModel}},mutations:{setFocusDevice(e,t){e.focusDevice=t},newMarkerCluster(e,t){e.markerCluster=new C.XL({map:t.map})},setDeviceIcon(e,t){if(e.deviceIcons[t.device_id]){let i={...e.deviceIcons};return i[t.device_id]=t.icon,void(e.deviceIcons=i)}e.deviceIcons[t.device_id]=t.icon},setDevices(e,t){e.devices=t},setGetDevicesTimeout(e,t){e.getDevicesTimeout=t},stopGetDevicesTimeout(e){clearTimeout(e.getDevicesTimeout)},changeHiddenDevice(e,t){if(e.deviceHiddenSettings){if(void 0==e.deviceHiddenSettings[t.device_id]){let i={...e.deviceHiddenSettings};return i[t.device_id]=!1,void(e.deviceHiddenSettings=i)}e.deviceHiddenSettings[t.device_id]=!e.deviceHiddenSettings[t.device_id]}},setAllHiddenDevices(e,{devices:t,value:i}){t.forEach((t=>{e.deviceHiddenSettings[t.device_id]=i}))},setLayoutModel(e,t){e.layoutModel=t},changeDeviceHeaderSetting(e,t){if(void 0==e.deviceHeaderSettings[t]){let i={...e.deviceHeaderSettings};return i[t]=!0,void(e.deviceHeaderSettings=i)}e.deviceHeaderSettings[t]=!e.deviceHeaderSettings[t]},setDeviceHeaderSettings(e,t){e.deviceHeaderSettings=t},setDeviceIconModal(e,t){e.deviceIconModel=t},setDeviceHeaderSettings(e,t){e.deviceHeaderSettings=t},setDeviceSortSettings(e,t){e.deviceSortSettings=t},setDeviceHiddenSettings(e,t){if(t){let i=e.devices;i&&i.forEach((e=>{e.show=!t[e.device_id]}))}e.deviceHiddenSettings=t},setDeviceFilterSettings(e,t){e.deviceFilterSettings=t}},actions:{closeDeviceIconModal({commit:e}){e("setDeviceIconModal",{device:null,show:!1})},showDeviceIconModal({commit:e},t){e("setDeviceIconModal",{device:t,show:!0})},changeDeviceHeaderSetting({commit:e},t){e("changeDeviceHeaderSetting",t)},setDeviceHeaderSettings({commit:e},t){e("setDeviceHeaderSettings",t)},setDefaultDeviceHeaderSettings({commit:e}){let t=JSON.parse(JSON.stringify(se));e("setDeviceHeaderSettings",t)},showLayoutModel({commit:e}){e("setLayoutModel",!0)},closeLayoutModel({commit:e}){e("setLayoutModel",!1)},getDevices({commit:e,state:t}){ne().then((({data:t})=>{e("setDevices",t)}))},startGetDevicesTimeout({commit:e,state:t}){const i=()=>{ne().then((({data:t})=>{let s=[];t.result_list.forEach((e=>{let t=new Z(e);s.push(t)})),e("setDevices",s),e("setGetDevicesTimeout",setTimeout(i,2e4))})).catch((t=>{console.error(t),e("setGetDevicesTimeout",setTimeout(i,2e4))}))};e("stopGetDevicesTimeout"),e("setGetDevicesTimeout",setTimeout(i,0))}},modules:{}});let oe=!1;const ae={getDeviceFilterSettings:()=>H().get("/api/device-filter-settings"),getAndStoreDeviceFilterSettings:(e=!1)=>{if(e&&re.state.deviceFilterSettings){let e=new Promise((e=>{e()}));return e}return H().get("/api/device-filter-settings").then((({data:e})=>{e&&re.commit("setDeviceFilterSettings",e.drive_status)}))},postAndStoreDeviceFilterSettings:(e,t=!1)=>{if(t&&re.commit("setDeviceFilterSettings",e.drive_status),oe){let e=new Promise((e=>{e()}));return e}oe=!0;let i=new FormData;return i.append("drive_status",e.drive_status),H().post("/api/device-filter-settings",i).then((i=>{t||re.commit("setDeviceFilterSettings",e.drive_status),oe=!1})).catch((e=>{oe=!1,console.error(e)}))}};var de=ae;let ce=!1;const le={getDeviceHeaderSettings:()=>H().get("/api/device-header-settings"),getAndStoreDeviceHeaderSettings:(e=!1)=>{if(e&&re.state.deviceHeaderSettings){let e=new Promise((e=>{e()}));return e}return H().get("/api/device-header-settings").then((({data:e})=>{e?re.commit("setDeviceHeaderSettings",e.header_settings):re.commit("setDeviceHeaderSettings",se)}))},postAndStoreDeviceHeaderSettings:(e,t=!1)=>{let i={header_settings:e.header_settings};if(t&&re.commit("setDeviceHeaderSettings",i.header_settings),ce){let e=new Promise((e=>{e()}));return e}return ce=!0,H().post("/api/device-header-settings",i).then((e=>{t||re.commit("setDeviceHeaderSettings",i.header_settings),ce=!1})).catch((e=>{ce=!1,console.error(e)}))}};var ve=le;let ue=!1;const he={getDeviceHiddenSettings:()=>H().get("/api/device-hidden-settings"),getAndStoreDeviceHiddenSettings:(e=!1)=>{if(e&&re.state.deviceHiddenSettings){let e=new Promise((e=>{e()}));return e}return H().get("/api/device-hidden-settings").then((({data:e})=>{e.hidden_devices?re.commit("setDeviceHiddenSettings",e.hidden_devices):re.commit("setDeviceHiddenSettings",{})}))},postDeviceHiddenSettings:e=>{if(ue){let e=new Promise((e=>{e()}));return e}ue=!0;let t={hidden_devices:e.hidden_devices};return H().post("/api/device-hidden-settings",t).then((e=>{ue=!1})).catch((e=>{ue=!1,console.error(e)}))},postAndStoreDeviceHiddenSettings:(e,t=!1)=>{let i={hidden_devices:e.hidden_devices};if(t&&re.commit("setDeviceHiddenSettings",i.hidden_devices),ue){let e=new Promise((e=>{e()}));return e}return ue=!0,H().post("/api/device-hidden-settings",i).then((e=>{t||re.commit("setDeviceHiddenSettings",i.hidden_devices),ue=!1})).catch((e=>{ue=!1,console.error(e)}))}};var pe=he;let ge=!1;const me={getDeviceSortSettings:()=>H().get("/api/device-sort-settings"),getAndStoreDeviceSortSettings:(e=!1)=>{if(e&&re.state.deviceSortSettings){let e=new Promise((e=>{e()}));return e}return H().get("/api/device-sort-settings").then((({data:e})=>{e&&re.commit("setDeviceSortSettings",{sort_by:e.sort_by,sort_desc:!!e.sort_desc})}))},postAndStoreDeviceSortSettings:(e,t=!1)=>{if(t&&re.commit("setDeviceSortSettings",{sort_by:e.sort_by,sort_desc:!!e.sort_desc}),ge){new Promise((e=>{e()}));return}ge=!0;let i=new FormData;return i.append("sort_by",e.sort_by),i.append("sort_desc",!!e.sort_desc),H().post("/api/device-sort-settings",i).then((i=>{ge=!1,t||re.commit("setDeviceSortSettings",{sort_by:e.sort_by,sort_desc:e.sort_desc})})).catch((e=>{ge=!1,console.error(e)}))}};var fe=me;const _e=i(3711);let Se=!1;const ye={getAndStoreDeviceIcon:e=>(re.state.deviceIcons[e]||re.commit("setDeviceIcon",{device_id:e,icon:_e}),H().get(`/api/device-icon/${e}`,{responseType:"blob"}).then((t=>{if(200==t.status){const i=window.URL.createObjectURL(new Blob([t.data]));re.commit("setDeviceIcon",{device_id:e,icon:i})}else re.commit("setDeviceIcon",{device_id:e,icon:_e})}))),postAndStoreDeviceIcon:(e,t=!1)=>{if(t&&re.commit("setDeviceIcon",{device_id:e.device_id,icon:e.file_url}),Se)return;let i=new FormData;return i.append("icon",e.icon),i.append("device_id",e.device_id),H().post("/api/device-icon",i).then((i=>{200==i.status&&(t||re.commit("setDeviceIcon",{device_id:e.device_id,icon:e.file_url}))})).catch((e=>console.error(e)))}};var De=ye,ke=function(){var e=this,t=e._self._c;return t("v-simple-table",{attrs:{dense:""}},[t("tbody",e._l(e.headers,(function(i){return t("tr",{key:i.text},[t("td",{staticClass:"key-text table-data"},[e._v(e._s(i.text))]),t("td",[e._v(e._s(e.item[i.value]))])])})),0)])},be=[],we={name:"DeviceTableExpandedItem",props:{item:Object},data:()=>({}),methods:{},computed:{headers(){return ie}}},Ie=we,He=i(9449),xe=(0,d.Z)(Ie,ke,be,!1,null,"115f7032",null),Ce=xe.exports;l()(xe,{VSimpleTable:He.Z});const{getAndStoreDeviceFilterSettings:Me,postAndStoreDeviceFilterSettings:$e}=de,{getAndStoreDeviceHeaderSettings:Te}=ve,{getAndStoreDeviceHiddenSettings:Ae,postDeviceHiddenSettings:Le}=pe,{getAndStoreDeviceSortSettings:Ze,postAndStoreDeviceSortSettings:Fe}=fe,{getAndStoreDeviceIcon:Oe}=De;var Pe={name:"DeviceTable",components:{DeviceTableExpandedItem:Ce},data:()=>({expanded:[],tabColors:{ALL:"blue-grey darken-4",DRIVING:"teal darken-4",IDLE:"blue darken-4",STOPPED:"red darken-4",NOSIGNAL:"grey darken-4"},sortBy:null,sortDesc:null,activeTab:0,tabs:["ALL","DRIVING","IDLE","STOPPED","NOSIGNAL"]}),mounted(){Me(!0),Te(!0),Ae(!0),Ze(!0).then((()=>{this.sortBy=this.sortSettings.sort_by,this.sortDesc=this.sortSettings.sort_desc})),this.activeTab=this.tabs.indexOf(this.statusFilter)},methods:{expand(e){if(this.expanded[0]==e)return this.expanded=[],void this.$store.commit("setFocusDevice",null);this.expanded=[e],this.$store.commit("setFocusDevice",e)},filterDevices(e){$e({drive_status:e},!0)},setAllHiddenDevices(){this.noHiddenDevices?this.$store.commit("setAllHiddenDevices",{devices:this.devices,value:!0}):this.$store.commit("setAllHiddenDevices",{devices:this.devices,value:!1}),Le({hidden_devices:this.hiddenSettings})},changeHiddenDevice(e){this.$store.commit("changeHiddenDevice",e),Le({hidden_devices:this.hiddenSettings})},changeIcon(e){this.$store.dispatch("showDeviceIconModal",e)},getInt(e){return isNaN(e)?"UNKNOWN":Math.floor(e)},getRowBackground(e){switch(e.drive_status){case"DRIVING":return"driving-row";case"IDLE":return"idle-row";case"STOPPED":return"stopped-row";default:return"nosignal-row"}},getIcon(e){return this.deviceIcons[e.device_id]||Oe(e.device_id),this.deviceIcons[e.device_id]},getSignalIcon(e){if(!e.online)return"mdi-wifi-strength-off";const t=e.rssi;switch(!0){case t<-120:return"mdi-wifi-strength-1";case t<-105:return"mdi-wifi-strength-2";case t<-90:return"mdi-wifi-strength-3";default:return"mdi-wifi-strength-4"}},getSignalColor(e){return e?"#388E3C":"grey darken-4"},getSignalInfo(e){if(!e.online)return"Connection: No";let t="";const i=e.rssi;switch(!0){case i<-120:t="Weak";break;case i<-105:t="Fair";break;case i<-90:t="Good";break;default:t="Excellent";break}return`Connection: Yes, RSSI: ${i} ${t}`},getActiveStateIcon(e){return"active"==e?"mdi-checkbox-marked-circle":"close-circle"},getActiveStateColor(e){return"active"==e?"green darken-2":"red darken-2"}},computed:{headers(){return this.$store.getters.deviceHeadersFiltered},unfilteredDevices(){return this.$store.getters.devices},devices(){return this.$store.getters.devicesFilterByStatus},statusFilter(){return this.$store.getters.deviceStatusFilter},sortSettings(){return this.$store.getters.deviceSortSettings},hiddenSettings(){return this.$store.getters.deviceHiddenSettings?this.$store.getters.deviceHiddenSettings:{}},deviceIcons(){return this.$store.getters.deviceIcons},tabColor(){return this.statusFilter?this.tabColors[this.statusFilter]:this.tabColors["ALL"]},deviceStatusCount(){let e=this.unfilteredDevices,t={ALL:0,DRIVING:0,IDLE:0,STOPPED:0,NOSIGNAL:0};return e.forEach((e=>{t["ALL"]++,t[e.drive_status]++})),t},noHiddenDevices(){let e=this.hiddenSettings;if(Object.keys(e).length<1)return!0;let t=this.devices,i=t.length;for(let s=0;s<i;s++)if(!e[t[s].device_id])return!0;return!1},eyeIcon(){return this.noHiddenDevices?"mdi-eye":"mdi-eye-off"}},watch:{statusFilter(){this.activeTab=this.tabs.indexOf(this.statusFilter)},sortBy(e,t){null!=t&&this.sortSettings.sort_by!=this.sortBy&&this.$nextTick().then((()=>{Fe({sort_by:this.sortBy,sort_desc:this.sortDesc},!0)}))},sortDesc(e,t){null!=t&&this.sortSettings.sort_desc!=this.sortDesc&&this.$nextTick().then((()=>{Fe({sort_by:this.sortBy,sort_desc:this.sortDesc},!0)}))}}},Ve=Pe,Ne=i(3423),Be=i(6570),Ee=i(9638),Ge=i(4324),je=i(6170),We=i(626),ze=i(1989),Re=i(1475),Ue=i(2082),Ke=i(6392),qe=i.n(Ke),Je=i(7069),Ye=(0,d.Z)(Ve,b,w,!1,null,null,null),Qe=Ye.exports;l()(Ye,{VAvatar:Ne.Z,VBtn:Be.Z,VDataTable:Ee.Z,VIcon:Ge.Z,VSimpleCheckbox:je.Z,VSpacer:g.Z,VTab:We.Z,VTabs:ze.Z,VTabsSlider:Re.Z,VTooltip:Ue.Z}),qe()(Ye,{Ripple:Je.Z});var Xe=function(){var e=this,t=e._self._c;return t("GoogleMapsLoader",{attrs:{mapConfig:e.mapConfig,apiKey:e.api},scopedSlots:e._u([{key:"default",fn:function({google:i,map:s}){return e.devices&&e.markerCluster?e._l(e.devices,(function(n){return t("GoogleMapsDeviceMarker",{key:n.device_id,attrs:{device:n,google:i,map:s,"marker-cluster":e.markerCluster}})})):void 0}}],null,!0)})},et=[],tt=function(){var e=this,t=e._self._c;return t("div",[t("div",{ref:"googleMap",staticClass:"google-map"}),Boolean(this.google)&&Boolean(this.map)?[e._t("default",null,{google:e.google,map:e.map})]:e._e()],2)},it=[],st=i(3311),nt={props:{mapConfig:Object,apiKey:String},data(){return{google:null,map:null}},async mounted(){const e=new st.aN({apiKey:this.apiKey});this.google=await e.load().catch((e=>console.error(e))),this.initializeMap()},methods:{initializeMap(){const e=this.$refs.googleMap;this.map=new this.google.maps.Map(e,this.mapConfig),this.$store.commit("newMarkerCluster",{map:this.map})}}},rt=nt,ot=(0,d.Z)(rt,tt,it,!1,null,"09909699",null),at=ot.exports,dt=function(){var e=this,t=e._self._c;return t("span",[t("div",{staticClass:"no-display",attrs:{id:`${e.id}_info_window`}},[t("div",{staticClass:"info-container"},[t("img",{attrs:{width:"32px",height:"32px",src:`${e.getIcon()}`}}),t("div",[e._v(e._s(e.name))])])])])},ct=[],lt=i(1436),vt={DRIVING:"#004D40",IDLE:"#0D47A1",STOPPED:"#B71C1C",NOSIGNAL:"#263238"},ut={props:{google:{type:Object,required:!0},map:{type:Object,required:!0},device:{type:Z,required:!0},markerCluster:{type:Object,required:!0}},data(){return{marker:null,infoWindow:null,templateInfo:null}},methods:{getIcon(){return this.deviceIcons[this.id]||getAndStoreDeviceIcon(this.id),this.deviceIcons[this.id]},appendToInfoWindow(){this.$nextTick((()=>{let e=document.getElementById(`${this.id}_info_id`),t=this.templateInfo;e&&t?(t.style.display="block",e.append(t)):setTimeout(this.appendToInfoWindow,1e3/30)}))},openInfoWindow(){const{InfoWindow:e}=this.google.maps;this.infoWindow&&null!=this.infoWindow.getMap()||(this.infoWindow=new e({content:`<div id="${this.id}_info_id"></div>`}),this.infoWindow.open({anchor:this.marker,map:this.map}),this.appendToInfoWindow())}},computed:{focusDevice(){return this.$store.getters.focusDevice},deviceIcons(){return this.$store.getters.deviceIcons},id(){return this.device.device_id},name(){return this.device.display_name},drive_status(){return this.device.drive_status},lat(){return this.device.lat},lng(){return this.device.lng},angle(){return this.device.angle+315},icon(){return{path:lt.$40.icon[4],fillColor:vt[this.drive_status],storkeColor:"#212121",fillOpacity:1,anchor:new google.maps.Point(lt.$40.icon[0]/2,lt.$40.icon[1]),scale:.075,rotation:this.angle}}},watch:{focusDevice(){this.focusDevice&&this.device&&this.focusDevice.device_id==this.id&&this.marker&&this.map.setCenter(this.marker.getPosition())},device(){if(this.marker){let e={lat:this.lat,lng:this.lng};this.marker.setPosition(e),this.marker.setIcon(this.icon)}}},mounted(){this.templateInfo=document.getElementById(`${this.id}_info_window`);const{Marker:e}=this.google.maps;let t={lat:this.lat,lng:this.lng};this.marker=new e({position:t,marker:{id:this.device.device_id,position:t},map:this.map,icon:this.icon}),this.markerCluster.addMarker(this.marker),this.openInfoWindow(),this.marker.addListener("click",(()=>this.openInfoWindow()))},beforeDestroy(){this.marker&&(this.infoWindow&&this.infoWindow.setMap(null),this.markerCluster.removeMarker(this.marker))},render(){}},ht=ut,pt=(0,d.Z)(ht,dt,ct,!1,null,"3cae038b",null),gt=pt.exports;const mt="AIzaSyCYud98BmGFWLy1U178Ocaet4bQ1CeHU6g",ft={clickableIcons:!1,streetViewControl:!1,panControlOptions:!1,gestureHandling:"cooperative",mapTypeControl:!0,zoomControlOptions:{style:"SMALL"},zoom:11};var _t={props:["devices"],components:{GoogleMapsLoader:at,GoogleMapsDeviceMarker:gt},data(){return{}},mounted(){},computed:{markerCluster(){return this.$store.getters.markerCluster},mapTypeId(){return this.$store.getters.mapTypeId},api(){return mt},mapConfig(){return{...ft,mapTypeId:this.mapTypeId,center:this.mapCenter}},mapCenter(){let e={lat:0,lng:0};return this.devices.length?(this.devices.forEach((t=>{e.lat+=t.lat,e.lng+=t.lng})),e.lat/=this.devices.length,e.lng/=this.devices.length,e):e}}},St=_t,yt=(0,d.Z)(St,Xe,et,!1,null,null,null),Dt=yt.exports,kt=function(){var e=this,t=e._self._c;return t("v-overlay",{attrs:{"z-index":e.zIndex},on:{click:e.close}},[t("v-sheet",{staticClass:"card-padding",attrs:{color:"white",elevation:"1",outlined:"",rounded:"",shaped:""},on:{click:function(e){e.stopPropagation()}}},[t("h1",{staticClass:"black-text"},[e._v("Layout Settings")]),t("v-divider",{staticClass:"border-color"}),t("div",{staticClass:"flex"},e._l(e.allHeaders,(function(i){return t("v-chip",{key:i.value,staticClass:"ma-2",attrs:{color:e.color(i),"text-color":e.textColor(i),ripple:""},on:{click:function(t){return e.changeHeader(i.value)}}},[e._v(" "+e._s(i.text)+" ")])})),1),t("v-divider",{staticClass:"border-color"}),t("div",{staticClass:"text-center",staticStyle:{"padding-top":"0.5rem"}},[t("v-btn",{staticClass:"white--text model-button",attrs:{color:"light-blue"},on:{click:e.revertToDefault}},[e._v(" Default ")]),t("v-btn",{staticClass:"white--text model-button",attrs:{color:"light-blue"},on:{click:e.save}},[e._v(" Save ")]),t("v-btn",{staticClass:"white--text model-button",attrs:{color:"light-blue"},on:{click:e.close}},[e._v(" Close ")])],1)],1)],1)},bt=[];const{postAndStoreDeviceHeaderSettings:wt}=ve;var It={name:"LayoutModel",props:["zIndex"],data:()=>({oldHeaders:{},deviceHeaders:{}}),methods:{close(){this.$store.dispatch("setDeviceHeaderSettings",this.oldHeaders),this.$store.dispatch("closeLayoutModel")},save(){wt({header_settings:this.deviceHeaders},!0),this.$store.dispatch("closeLayoutModel")},color(e){return this.deviceHeaders[e.value]?"blue":"grey"},textColor(e){return this.deviceHeaders[e.value]?"white":"black"},changeHeader(e){this.$store.dispatch("changeDeviceHeaderSetting",e),this.deviceHeaders=this.$store.getters.deviceHeaderSettings},revertToDefault(){this.$store.dispatch("setDefaultDeviceHeaderSettings"),this.deviceHeaders=this.$store.getters.deviceHeaderSettings}},computed:{allHeaders(){return ee}},mounted(){this.deviceHeaders=this.$store.getters.deviceHeaderSettings,this.oldHeaders=JSON.parse(JSON.stringify(this.deviceHeaders))}},Ht=It,xt=i(4127),Ct=i(9223),Mt=i(2933),$t=i(7423),Tt=(0,d.Z)(Ht,kt,bt,!1,null,"413d5d38",null),At=Tt.exports;l()(Tt,{VBtn:Be.Z,VChip:xt.Z,VDivider:Ct.Z,VOverlay:Mt.Z,VSheet:$t.Z});var Lt=function(){var e=this,t=e._self._c;return t("div",[t("v-overlay",{attrs:{"z-index":e.zIndex}},[t("v-sheet",{staticClass:"card-padding",attrs:{color:"white",elevation:"1",outlined:"",rounded:"",shaped:"",light:""}},[t("h1",{staticClass:"black-text"},[e._v(e._s(`Icon Upload - ${e.name}`))]),t("v-divider",{staticClass:"border-color"}),t("div",{staticClass:"image-preview-div image-preview-size"},[e.previewFile?t("img",{staticClass:"image-preview-size",attrs:{src:e.previewFile}}):t("v-sheet",{staticClass:"icon-placeholder-div image-preview-size"},[t("v-icon",{staticClass:"icon-placeholder"},[e._v("mdi-image")])],1)],1),t("v-divider",{staticClass:"border-color"}),t("v-file-input",{attrs:{label:"*png, *jpg, *jpeg",filled:"","prepend-icon":"mdi-camera",accept:"image/png, image/jpeg, image/jpg"},on:{change:e.fileSelected}}),t("div",{staticClass:"justify-center"},[t("v-btn",{staticClass:"white--text model-button",attrs:{color:"light-blue"},on:{click:e.close}},[e._v(" Close ")]),t("v-btn",{staticClass:"white--text model-button",attrs:{color:"light-blue",disabled:!e.selectedFile},on:{click:e.upload}},[e._v(" Upload ")])],1)],1)],1),e.posting?t("v-overlay",{attrs:{"z-index":e.zIndex+1}}):e._e()],1)},Zt=[];const{postAndStoreDeviceIcon:Ft}=De;var Ot={name:"DeviceIconModel",props:["zIndex"],data:()=>({previewFile:null,selectedFile:null,posting:!1}),methods:{close(){this.$store.dispatch("closeDeviceIconModal")},upload(){this.posting=!0,Ft({icon:this.selectedFile,device_id:this.id,file_url:this.previewFile}).then((()=>{this.$store.dispatch("closeDeviceIconModal")}))},setPreviewImage(e){if(e){let t=new FileReader;t.onload=e=>{this.previewFile=e.target.result},t.readAsDataURL(e)}else this.previewFile=null},fileSelected(e){this.selectedFile=e,this.setPreviewImage(e)}},computed:{device(){return this.$store.getters.deviceIconModel.device},id(){return this.device.device_id},name(){return this.device.display_name}},mounted(){}},Pt=Ot,Vt=i(1625),Nt=(0,d.Z)(Pt,Lt,Zt,!1,null,"34e54c9e",null),Bt=Nt.exports;l()(Nt,{VBtn:Be.Z,VDivider:Ct.Z,VFileInput:Vt.Z,VIcon:Ge.Z,VOverlay:Mt.Z,VSheet:$t.Z});var Et={name:"DevicePage",components:{DeviceTable:Qe,DeviceMap:Dt,LayoutModel:At,DeviceIconModel:Bt},data:()=>({device:!0,showMap:!1}),computed:{devices(){return this.$store.getters.devicesFilterByStatus},shownDevices(){return this.$store.getters.devicesFilterByStatusAndHidden},layoutModel(){return this.$store.getters.layoutModel},deviceIconModel(){return this.$store.getters.deviceIconModel}},watch:{devices(){this.devices.length>0&&(this.showMap=!0)}}},Gt=Et,jt=i(2118),Wt=i(5808),zt=i(4525),Rt=i(5187),Ut=i(7094),Kt=i(1713),qt=(0,d.Z)(Gt,D,k,!1,null,"4f01f937",null),Jt=qt.exports;l()(qt,{VContainer:jt.Z,VIcon:Ge.Z,VList:Wt.Z,VListItem:zt.Z,VListItemAction:Rt.Z,VNavigationDrawer:Ut.Z,VRow:Kt.Z});var Yt={name:"HomeView",components:{DevicePage:Jt},mounted(){this.$store.dispatch("startGetDevicesTimeout")}},Qt=Yt,Xt=(0,d.Z)(Qt,S,y,!1,null,null,null),ei=Xt.exports;s.ZP.use(_.Z);const ti=[{path:"/",name:"home",component:ei},{path:"/about",name:"about",component:()=>i.e(443).then(i.bind(i,1207))}],ii=new _.Z({mode:"history",base:"/",routes:ti});var si=ii,ni=i(1705);s.ZP.use(ni.Z);var ri=new ni.Z({});s.ZP.config.productionTip=!1,new s.ZP({router:si,store:re,vuetify:ri,render:e=>e(f)}).$mount("#app")},7504:function(e,t,i){e.exports=i.p+"static/img/OSGPS.adf24436.png"},3711:function(e,t,i){e.exports=i.p+"static/img/placeholder.92c41dd8.png"}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}i.m=e,function(){var e=[];i.O=function(t,s,n,r){if(!s){var o=1/0;for(l=0;l<e.length;l++){s=e[l][0],n=e[l][1],r=e[l][2];for(var a=!0,d=0;d<s.length;d++)(!1&r||o>=r)&&Object.keys(i.O).every((function(e){return i.O[e](s[d])}))?s.splice(d--,1):(a=!1,r<o&&(o=r));if(a){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[s,n,r]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,s){return i.f[s](e,t),t}),[]))}}(),function(){i.u=function(e){return"static/js/about.1ef64240.js"}}(),function(){i.miniCssF=function(e){}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="client:";i.l=function(s,n,r,o){if(e[s])e[s].push(n);else{var a,d;if(void 0!==r)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var v=c[l];if(v.getAttribute("src")==s||v.getAttribute("data-webpack")==t+r){a=v;break}}a||(d=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",t+r),a.src=s),e[s]=[n];var u=function(t,i){a.onerror=a.onload=null,clearTimeout(h);var n=e[s];if(delete e[s],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((function(e){return e(i)})),t)return t(i)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),d&&document.head.appendChild(a)}}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p="/"}(),function(){var e={143:0};i.f.j=function(t,s){var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)s.push(n[2]);else{var r=new Promise((function(i,s){n=e[t]=[i,s]}));s.push(n[2]=r);var o=i.p+i.u(t),a=new Error,d=function(s){if(i.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var r=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,n[1](a)}};i.l(o,d,"chunk-"+t,t)}},i.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,r,o=s[0],a=s[1],d=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(n in a)i.o(a,n)&&(i.m[n]=a[n]);if(d)var l=d(i)}for(t&&t(s);c<o.length;c++)r=o[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(l)},s=self["webpackChunkclient"]=self["webpackChunkclient"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(6076)}));s=i.O(s)})();
//# sourceMappingURL=app.0b27a8e1.js.map